"use strict";(self.webpackChunkartgallery=self.webpackChunkartgallery||[]).push([[989],{5290:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(2791),a="Comment_main__PxH60",s="Comment_header__9qJvQ",o="Comment_leftHeader__t0E2L",i="Comment_rightHeader__2NXYZ",c="Comment_body__totnP",l="Comment_dp__xuFKb",m="Comment_nameRatingCtn__TPceA",u="Comment_name__RBLlx",d="Comment_rating__mUXj8",v=t(8316),g=t(184),p=r.memo((function(e){var n=e.name,t=e.dp,r=e.rating,p=e.message,_=e.date;return(0,g.jsxs)("div",{className:a,children:[(0,g.jsxs)("div",{className:s,children:[(0,g.jsxs)("div",{className:o,children:[(0,g.jsx)("img",{className:l,src:t,alt:""}),(0,g.jsxs)("span",{className:m,children:[(0,g.jsx)("h3",{className:u,children:n}),(0,g.jsx)(v.Z,{size:"small",defaultValue:r,className:d,readOnly:!0})]})]}),(0,g.jsx)("div",{className:i,children:new Date(_).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})})]}),(0,g.jsx)("div",{className:c,children:p})]})}))},2989:function(e,n,t){t.r(n),t.d(n,{default:function(){return w}});var r=t(4165),a=t(1413),s=t(3433),o=t(5861),i=t(9439),c=t(2791),l={main:"Review_main__1SObe",ratingCtn:"Review_ratingCtn__06TEK",ratingDisplay:"Review_ratingDisplay__5yQzo",ratingProgressCtn:"Review_ratingProgressCtn__HOziM",progressBar:"Review_progressBar__e7O5Y",progressLabel:"Review_progressLabel__ANS5q",ratingSlider:"Review_ratingSlider__e1Wi6",commentCtn:"Review_commentCtn__YXLDW",reviewPopupBox:"Review_reviewPopupBox__8k2t2",commentText:"Review_commentText__FKtUL",closeBtn:"Review_closeBtn__vWPsI"},m=t(8316),u=t(4294),d=t(6994),v=t(184),g=c.memo((function(e){var n=e.type,t=e.value,r=e.color;return(0,v.jsxs)("div",{className:l.progressBar,children:[(0,v.jsx)("span",{className:l.progressLabel,children:n}),(0,v.jsx)(d.ZP,{className:l.ratingSlider,value:t,sx:{color:"".concat(r,"!important"),"& .MuiSlider-thumb":{display:"none"}}})]})})),p=t(5290),_=t(9823),x=t(9434),h=t(9002),f=t(7689),j=c.memo((function(){var e=(0,c.useState)({rating:0,comment:""}),n=(0,i.Z)(e,2),t=n[0],d=n[1],j=(0,c.useState)(!1),w=(0,i.Z)(j,2),y=w[0],C=w[1],N=(0,x.I0)(),b=(0,x.v9)((function(e){return e.user})),Z=b.currentUser,S=b.activePage,R=(0,f.UO)();console.log("review ...");var P=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var o,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("fetch in review ..."),e.prev=1,n.preventDefault(),0!==t.rating){e.next=6;break}return N((0,h.br)({type:"warning",message:"Rate by clicking the stars (1-5)"})),e.abrupt("return");case 6:return e.next=8,fetch("/api/register/".concat(R.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({comments:[].concat((0,s.Z)(null===S||void 0===S?void 0:S.comments),[{name:Z.username,dp:Z.avatar,message:t.comment,rating:t.rating,createdAt:(new Date).toISOString()}])})});case 8:return o=e.sent,e.next=11,o.json();case 11:if(!1!==(i=e.sent).success){e.next=15;break}return N((0,h.br)({type:"error",message:i.message})),e.abrupt("return");case 15:N((0,h.vT)((0,a.Z)((0,a.Z)({},S),{},{comments:[].concat((0,s.Z)(null===S||void 0===S?void 0:S.comments),[{name:Z.username,dp:Z.avatar,message:t.comment,rating:t.rating,createdAt:(new Date).toISOString()}])}))),N((0,h.br)({type:"success",message:"Your comment is live"})),k(),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(1),N((0,h.br)({type:"error",message:"Oops! Something went wrong. Please try again later or contact support."})),console.log(e.t0);case 24:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(n){return e.apply(this,arguments)}}(),B=function(e){var n=e.target,r=n.name,s=n.value;d("rating"===r?(0,a.Z)((0,a.Z)({},t),{},{rating:Number(s)}):(0,a.Z)((0,a.Z)({},t),{},{comment:s}))},k=function(){C(!1),d({rating:0,comment:""})},F=(0,c.useMemo)((function(){var e=null===S||void 0===S?void 0:S.comments.reduce((function(e,n){return e+n.rating||0}),0),n=e/(null===S||void 0===S?void 0:S.comments.length)||0;return console.log(e+" total "),parseFloat(n.toFixed(1))}),[null===S||void 0===S?void 0:S.comments]),D=function(e){var n=(null===S||void 0===S?void 0:S.comments.filter((function(n){return n.rating===e})).length)/(null===S||void 0===S?void 0:S.comments.length)*100||0;return console.log(Math.round(n)+"-".concat(e,"%")),Math.round(n)};return(0,v.jsxs)("div",{className:l.main,children:[y&&(0,v.jsxs)("form",{onSubmit:P,className:l.reviewPopupBox,children:[(0,v.jsx)(_.Z,{onClick:k,className:l.closeBtn}),(0,v.jsx)("h3",{children:"Write Review"}),(0,v.jsx)("textarea",{name:"comment",value:t.comment,onChange:B,className:l.commentText,cols:"37",rows:"5",required:!0}),(0,v.jsx)(m.Z,{name:"rating",value:t.rating,onChange:B,size:"large",className:l.ratingInput,required:!0}),(0,v.jsx)(u.Z,{variant:"contained",type:"submit",children:"Submit"})]}),(0,v.jsxs)("div",{className:l.ratingCtn,children:[(0,v.jsxs)("div",{className:l.ratingDisplay,children:[(0,v.jsx)("h1",{children:F||"No Ratings"}),(0,v.jsx)(m.Z,{value:F,precision:.5,readOnly:!0}),(0,v.jsxs)("p",{children:["Based on ",null===S||void 0===S?void 0:S.comments.length," reviews"]}),Z&&(0,v.jsx)("button",{onClick:function(){return C(!0)},children:"Write Review"})]}),(0,v.jsxs)("div",{className:l.ratingProgressCtn,children:[(0,v.jsx)(g,{type:"Excellent",color:"#00B050",value:(0,c.useMemo)((function(){return D(5)}),[null===S||void 0===S?void 0:S.comments])},"5"),(0,v.jsx)(g,{type:"Good",color:"#92D050",value:(0,c.useMemo)((function(){return D(4)}),[null===S||void 0===S?void 0:S.comments])},"4"),(0,v.jsx)(g,{type:"Average",color:"#FFFF00",value:(0,c.useMemo)((function(){return D(3)}),[null===S||void 0===S?void 0:S.comments])},"3"),(0,v.jsx)(g,{type:"Below Average",color:"#FFC000",value:(0,c.useMemo)((function(){return D(2)}),[null===S||void 0===S?void 0:S.comments])},"2"),(0,v.jsx)(g,{type:"Poor",color:"#FF0000",value:(0,c.useMemo)((function(){return D(1)}),[null===S||void 0===S?void 0:S.comments])},"1")]})]}),(0,v.jsxs)("div",{className:l.commentCtn,children:[null===S||void 0===S?void 0:S.comments.map((function(e){return(0,v.jsx)(p.Z,{name:e.name,dp:e.dp,message:e.message,rating:e.rating,date:e.createdAt},e._id)})),0===(null===S||void 0===S?void 0:S.comments.length)&&(0,v.jsx)("h1",{style:{color:"#515151",textAlign:"center"},children:"Be the first to comment"})]})]})})),w=j}}]);
//# sourceMappingURL=989.e838d597.chunk.js.map